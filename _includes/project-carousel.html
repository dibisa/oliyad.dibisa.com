<div class="carousel-container" id="carousel-container">
  <!-- Project title + description -->
  <div class="carousel-header">
    <h2 id="carousel-title">Featured</h2>
    <p id="carousel-description"></p>
  </div>

  <!-- Media viewer with project navigation (big watermark arrows) -->
  <div class="media-viewer-wrapper">
    <button class="carousel-nav carousel-nav-prev" id="project-prev" aria-label="Previous project">
      <span class="watermark-arrow">‹</span>
    </button>
    
    <div class="media-viewer" id="media-viewer">
      <!-- Media item rendered here by JS -->
    </div>

    <button class="carousel-nav carousel-nav-next" id="project-next" aria-label="Next project">
      <span class="watermark-arrow">›</span>
    </button>
  </div>

  <!-- Media navigation (within-project prev/next) -->
  <div class="media-nav-controls">
    <button id="media-prev" class="media-nav-btn" aria-label="Previous media">‹ Prev</button>
    <span id="media-counter" class="media-counter">1 / 1</span>
    <button id="media-next" class="media-nav-btn" aria-label="Next media">Next ›</button>
  </div>
</div>

<script>
  (function() {
    const projects = {{ site.data.projects | jsonify }};
    
    if (!projects || projects.length === 0) {
      document.getElementById('carousel-container').innerHTML = '<p>No projects found.</p>';
      return;
    }

    let currentProjectIdx = 0;
    let currentMediaIdx = 0;

    function renderMedia() {
      const project = projects[currentProjectIdx];
      const media = project.media[currentMediaIdx];
      
      // Update header
      document.getElementById('carousel-title').textContent = project.title;
      document.getElementById('carousel-description').textContent = project.description;

      // Render media item
      const viewer = document.getElementById('media-viewer');
      viewer.innerHTML = '';
      if (media.type === 'image') {
        const img = document.createElement('img');
        img.src = media.src;
        img.alt = media.alt || project.title;
        img.style.maxWidth = '100%';
        img.style.height = 'auto';
        viewer.appendChild(img);
      } else if (media.type === 'video') {
        const video = document.createElement('video');
        video.src = media.src;
        video.controls = true;
        video.style.maxWidth = '100%';
        video.style.height = 'auto';
        viewer.appendChild(video);
      }

      // Update counter
      document.getElementById('media-counter').textContent = 
        `${currentMediaIdx + 1} / ${project.media.length}`;

      // Update button states
      document.getElementById('media-prev').disabled = currentMediaIdx === 0;
      document.getElementById('media-next').disabled = currentMediaIdx === project.media.length - 1;
    }

    // Project navigation
    document.getElementById('project-prev').addEventListener('click', function() {
      currentProjectIdx = (currentProjectIdx - 1 + projects.length) % projects.length;
      currentMediaIdx = 0;
      renderMedia();
    });

    document.getElementById('project-next').addEventListener('click', function() {
      currentProjectIdx = (currentProjectIdx + 1) % projects.length;
      currentMediaIdx = 0;
      renderMedia();
    });

    // Media navigation
    document.getElementById('media-prev').addEventListener('click', function() {
      if (currentMediaIdx > 0) {
        currentMediaIdx--;
        renderMedia();
      }
    });

    document.getElementById('media-next').addEventListener('click', function() {
      const project = projects[currentProjectIdx];
      if (currentMediaIdx < project.media.length - 1) {
        currentMediaIdx++;
        renderMedia();
      }
    });

    // Initial render
    renderMedia();
  })();
</script>

